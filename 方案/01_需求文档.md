# 微波研发部门研发管理平台

## 需求梳理与补全文档

**文档编号**: RDP-REQ-2026-001  
**版本**: V1.0  
**编制日期**: 2026年2月20日  
**密级**: 内部公开  
**状态**: 初稿

---

## 目录

1. 文档概述
2. 业务背景与目标
3. 组织架构分析
4. 功能需求梳理（原始需求 + 补全）
5. 非功能需求补全
6. 集成需求补全
7. 数据需求补全
8. 需求优先级与分期规划
9. 需求追踪矩阵
10. 需求优化记录

---

## 1. 文档概述

### 1.1 文档目的

本文档对微波研发部门提出的研发管理平台需求进行系统性梳理，识别原始需求中的隐含要求和缺失项，并进行完整补全。梳理后的需求将作为后续《详细实施方案》和《需求规格说明书》的输入基线。

### 1.2 适用范围

本文档适用于微波研发部门全体人员，涵盖产品管理、产品开发、技术开发三个实体团队及综合管理虚拟团队。平台将部署在离线局域网环境，支持日常研发管理的全部业务流程。

### 1.3 术语定义

| 术语 | 定义 |
|------|------|
| **IPD** | 集成产品开发（Integrated Product Development），华为引入的产品开发管理体系 |
| **DCP** | 决策评审点（Decision Checkpoint），项目关键里程碑评审 |
| **单机** | 微波系统中的独立功能单元，由多个模块集成而成 |
| **通用模块** | 可在多个单机产品中复用的标准化功能模块 |
| **产品货架** | 经过验证和审批的成熟产品/模块集合，供设计师选用集成 |
| **技术货架** | 部门已掌握的技术能力集合，含方法、电路、算法等 |
| **L1-L4流程** | 四级流程体系，L1流程层(主流程/子流程)、L2活动层、L3任务层、L4操作层(指导书/模板)，用于IPD研发流程的层级分解 |
| **RFSoC** | 射频系统芯片（Radio Frequency System on Chip） |
| **SDR** | 软件定义无线电（Software Defined Radio） |
| **AI Agent** | 人工智能代理，本项目中指负责特定模块开发的智能程序 |
| **PM-Agent** | 项目经理Agent，负责全局质量把控和进度协调的AI Agent |
| **功能Agent** | 负责具体功能模块开发的AI Agent，如PortalAgent、UserAgent等 |

### 1.4 开发模式说明

> **⚠️ 重要声明：本项目采用AI Agent集群自主开发模式**
>
> 本项目不同于传统软件开发模式，采用**AI Agent自主开发**方式：
> - **功能Agent**：每个功能模块由专门的AI Agent负责（如PortalAgent负责门户、UserAgent负责用户管理等）
> - **PM-Agent**：设置项目经理Agent进行全局质量把控和进度协调
> - **无时间限制**：分期仅表示先后顺序，不设定具体时间，由PM-Agent根据质量决定进度
> - **质量优先**：只有通过PM-Agent审查的代码才能进入下一阶段
>
> 本文档中的"开发团队"、"负责人员"均指对应的AI Agent角色。

---

## 2. 业务背景与目标

### 2.1 业务背景

微波研发部门承担通信和探测微波系统的研发工作，产品线涵盖A、B、C三类产品。部门采用"平台化+模块化"的研发策略：技术开发团队负责通用模块和技术的研发，产品开发团队通过选用货架模块进行单机集成，产品管理团队负责需求对接和产品全生命周期管理。

当前面临的核心问题：
- 研发知识分散在个人电脑，缺乏组织级沉淀和复用机制
- 项目管理依赖线下手段（Excel/邮件/会议），进度跟踪困难
- 产品/技术复用率低，缺乏便捷的货架选用机制
- 设计文档版本管理混乱，协同效率低下
- 流程执行靠人工驱动，缺乏数字化流程引擎

### 2.2 建设目标

**总体目标**：建设一套面向微波研发部门的一体化研发管理平台，实现项目管理数字化、研发流程自动化、知识资产结构化、产品技术货架化，提升研发效率和产品复用率。

| 目标 | 说明 |
|------|------|
| **G1-流程数字化** | 将L1-L4级研发流程固化到系统中，实现流程驱动的项目执行 |
| **G2-知识资产化** | 建立组织级知识库，实现知识的采集、分类、检索和智能推荐 |
| **G3-产品货架化** | 将成熟产品和技术上架管理，支持一键选用和集成 |
| **G4-协同高效化** | 提供即时通信、论坛、项目协同等工具，打通团队沟通壁垒 |
| **G5-管理可视化** | 通过仪表盘、甘特图、统计报表等实现管理决策的数据支撑 |

### 2.3 约束条件

| 约束类型 | 约束内容 | 影响 |
|----------|----------|------|
| **网络环境** | 离线局域网部署，不可连接互联网 | 所有依赖需离线可用，无法使用CDN或云服务 |
| **安全保密** | 涉密环境，数据不可外泄 | 需严格权限控制、审计日志、数据加密 |
| **本地工具集成** | 需与Altium Designer、Obsidian、Zotero等本地软件联动 | 需设计本地协议注册和文件关联机制 |
| **用户规模** | 部门级（预计30-100人） | 不需要大规模分布式架构 |
| **技术能力** | 使用方以设计师为主，非专业IT人员 | 操作界面需简洁友好，降低学习成本 |

---

## 3. 组织架构分析

### 3.1 团队结构梳理

```
微波研发部门
├── 产品管理团队
│   ├── 型号管理
│   └── 可靠性管理
├── 产品开发团队
│   ├── A产品线
│   ├── B产品线
│   └── C产品线
├── 技术开发团队
│   ├── 天线设计
│   ├── 射频设计（接收通道、功放、频率源、变频模块）
│   ├── 数字设计（FPGA+ADC/SDR、RFSoC）
│   └── 电源设计（低压二次电源）
└── 综合管理（虚拟团队）
    ├── 安全
    ├── 保密
    ├── 档案
    ├── 宣传
    ├── 6S
    └── 党建
```

**角色说明**：
- 设计师职称体系: 设计员 → 助理工程师 → 工程师 → 高级工程师(副高) → 研究员(正高)
- 射频设计师细分: 接收通道、功放、频率源、变频模块等方向
- 数字设计师工作: FPGA + ADC/SDR、RFSoC等硬件设计
- 系统角色: 管理员、部门领导、团队组长、设计师、其他(兼职综合管理人员)

### 3.2 角色与职责矩阵

| 角色 | 权限级别 | 核心职责 | 系统功能范围 |
|------|----------|----------|--------------|
| **系统管理员** | 最高 | 系统配置、用户管理、权限分配 | 全部模块管理权限 |
| **部门领导** | 高（可兼管理员） | 部门管理、项目审批、资源统筹 | 项目审批、全局仪表盘、人员管理 |
| **团队组长** | 中 | 团队管理、任务分配、进度把控 | 本团队项目管理、任务分配、进度查看 |
| **设计师** | 标准 | 项目执行、设计开发、文档编写 | 个人项目开发、知识贡献、货架选用 |
| **综合管理人员** | 标准+特定 | 兼职管理（安全/保密/档案等） | 对应管理模块 + 设计师基础权限 |
| **访客/其他** | 低 | 浏览查看 | 公开信息查看 |

> **补全项**：原需求未明确的权限要求已补全——需要支持数据权限隔离（不同产品线设计师默认只能看到本产品线项目）和审批流权限（组长可审批团队内任务，部门领导审批跨团队资源调配）。

### 3.3 业务流程全景

```
需求对接 → 产品管理
    ↓
需求分析 → 指标分解计算
    ↓
模块选用/开发 → 查看产品货架 → 选用
                无合适模块 → 技术开发
    ↓
模块/技术开发 → 技术开发团队
    ↓
技术上架 → 技术货架
    ↓
单机集成 → 产品开发
    ↓
测试 → 产品上架
    ↓
批产/入货架
    ↓
设计知识 → 知识库沉淀
```

**核心业务闭环**: 需求 → 指标分解 → 模块选用(货架)/模块开发(技术开发) → 单机集成 → 测试验证 → 产品上架(货架) → 知识沉淀(知识库)

---

## 4. 功能需求梳理（原始需求 + 补全）

### 4.1 门户界面模块

**原始需求**：
- 参考 github.com/Paniche/department_homepage（React + Vite + TypeScript + Tailwind CSS）
- 在门户页面中增加"工作台"，将各功能模块集成到工作台中

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **部门门户首页** | 展示部门简介、新闻公告、荣誉展示、快捷导航。参考department_homepage布局 | P0 |
| **个人工作台** | 登录后的个人工作中心：待办事项、我的项目、消息通知、快捷入口 | P0 |
| **全局搜索** | 跨模块全文搜索（项目、知识、产品、人员） | P1 |
| **消息通知中心** | 系统通知、项目提醒、审批待办、@提及的统一入口 | P0 |
| **快捷操作面板** | 新建项目、新建文档、查看待办等常用操作一键直达 | P1 |
| **部门数据概览看板** | 项目总数/进行中/已完成、货架产品数、知识库文档数等统计 | P1 |
| **主题/布局设置** | 支持浅色/深色主题切换，工作台布局可定制 | P2 |
| **响应式适配** | 适配常规桌面分辨率（1920×1080为主），兼顾笔记本屏幕 | P1 |

### 4.2 用户管理模块

**原始需求**：
- 五类角色：管理员、部门领导、团队组长、设计师、其他
- 设计师按团队分组，含详细的专业方向和职称体系
- 管理员可设置角色，设置后有可视化标记
- 个人页面类似GitHub Profile：基本信息、荣誉、项目、能力图、活跃度
- 支持按团队/岗位查看成员

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **用户注册/导入** | 支持管理员批量导入用户（Excel）、单个添加；首次登录强制改密 | P0 |
| **RBAC权限模型** | 基于角色的访问控制，支持角色继承（部门领导继承组长权限） | P0 |
| **组织架构树** | 可视化组织架构图，支持拖拽调整，一目了然各团队编制 | P1 |
| **技能标签体系** | 为设计师标注技能标签（如"微带天线"、"GaN功放"、"FPGA时序"），支持按技能搜索 | P1 |
| **能力雷达图** | 用ECharts雷达图展示设计师多维能力评估（设计、仿真、测试、文档、创新等） | P1 |
| **贡献热力图** | 类GitHub贡献日历，展示设计师平台使用活跃度（提交文档、完成任务等） | P1 |
| **项目履历** | 个人页面展示历史参与项目列表、角色、成果 | P1 |
| **荣誉墙** | 展示获奖、专利、论文发表等荣誉 | P2 |
| **密码策略** | 密码复杂度要求、定期更换提醒、登录失败锁定 | P0 |
| **操作审计日志** | 记录用户登录、权限变更、关键操作日志 | P0 |

### 4.3 项目管理模块

**原始需求**：
- 项目全生命周期管理：创建、计划、执行、跟踪、收尾
- 项目创建向导（五步流程）
- 项目类别：单机/模块/软件/技术开发/流程开发/知识库开发/产品上架
- 自动排程引擎 + 甘特图，支持MS Project导入导出
- 标准化项目文件夹，支持本地+服务器同步，Git版本管理
- 项目仪表盘：进度、成本、质量、风险多维可视化

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **项目总览看板** | 全部门项目鸟瞰图，支持按产品线/时间/负责人/状态多维筛选排序 | P0 |
| **项目创建向导** | 五步引导：① 基本信息 → ② 类别选择 → ③ 流程绑定 → ④ 团队分配 → ⑤ 计划确认 | P0 |
| **流程模板库** | 预置各类别项目的标准流程模板，可自定义新建模板 | P0 |
| **甘特图组件** | 可交互甘特图，支持任务拖拽调整、依赖关系连线、关键路径标识 | P0 |
| **MS Project互操作** | 支持导入.mpp文件生成甘特图，支持导出为.mpp格式 | P1 |
| **项目文件夹管理** | 项目创建时自动生成标准目录结构；支持服务器-本地双向同步 | P0 |
| **Git版本控制** | 项目文件自动纳入Git管理，自动commit/push，版本历史可追溯 | P0 |
| **多维仪表盘** | 进度（甘特/燃尽图）、质量（问题数/趋势）、风险（风险矩阵）、资源（工时统计） | P1 |
| **超期预警** | 任务到期前N天自动提醒，超期任务红色标识 + 通知责任人和上级 | P0 |
| **资源日历** | 按人员查看工作负荷、任务分布，避免资源冲突 | P1 |
| **项目模板** | 从历史成功项目一键创建模板，新项目可基于模板快速启动 | P1 |
| **项目归档** | 项目完成后一键归档，归档数据不可修改但可查看 | P1 |

### 4.4 项目开发模块

**原始需求**：
- 不同项目类别有不同的开发界面和流程
- 流程可视化执行：流程全景图、活动高亮、输入输出交付物
- 任务面板：认领、进度填报、交付物上传、完成确认
- 问题与决策管理，DCP评审强制触发
- Web端+本地软件联动（Markdown/Obsidian编辑、Altium Designer打开PCB文件）
- 文件Git版本管理，自动commit
- 活动完成自动更新项目进度到各关联模块
- 活动内容由流程模板决定，自动关联参考资料（通过标签）

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **流程全景视图** | BPMN风格的流程图，当前活动高亮，已完成/未开始状态区分 | P0 |
| **活动详情面板** | 展示活动定义、输入文档、输出模板、执行指南、参考资料 | P0 |
| **本地文件协议** | 注册自定义协议(rdp://)，点击文件可调用本地软件打开（Altium/Office/Obsidian等） | P0 |
| **Web端Markdown编辑器** | 内置Markdown编辑器，支持实时预览、图片插入、表格、数学公式 | P0 |
| **文件预览引擎** | Web端预览PDF/Office/图片/Gerber文件，生成预览格式副本 | P1 |
| **评审/反馈系统** | 活动内对输入文件提问/反馈，支持@通知、评论线程、修改追踪 | P0 |
| **自动化触发** | 活动完成 → 自动更新项目进度 → 通知下一活动负责人 → 触发后续流程 | P0 |
| **DCP评审门** | 关键节点强制评审，评审通过方可继续，记录评审意见和决策 | P0 |
| **并行活动支持** | 支持流程中的并行分支（如硬件设计和结构设计同步进行） | P1 |
| **变更管理** | 需求/设计变更申请、影响分析、审批、执行、验证闭环 | P1 |
| **工时记录** | 设计师填报各活动实际工时，自动汇总到项目仪表盘 | P2 |

### 4.5 产品货架模块

**原始需求**：
- 分类浏览上架产品（单机/模块/软件/基础四类）
- 产品详情：介绍、图片、测试数据、应用履历、问题记录、开发人员等
- 类似淘宝/京东的"加入购物车"选用机制
- 基于产品相似创建新项目或迭代修改
- 多维度筛选：类型、规格、成熟度、授权方式

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **产品卡片视图** | 类电商商品列表，展示缩略图、名称、型号、成熟度等级、负责人 | P0 |
| **成熟度标签** | 标记产品成熟度：研发中/初样/正样/定型/批产 五级 | P0 |
| **选用购物车** | 将产品资料包加入"选用清单"，一键导入项目文件夹。选用流程：浏览产品→加入选用单→提交审批→审批通过→产品出库→应用反馈 | P0 |
| **应用履历追踪** | 记录产品在各项目中的应用情况、性能表现、问题反馈 | P1 |
| **版本管理** | 产品迭代版本树，支持diff对比不同版本差异 | P1 |
| **替代关系维护** | 标记产品间的替代/升级关系，停产产品推荐替代品 | P1 |
| **技术支持入口** | 选用产品后可直接联系产品负责人获取技术支持 | P2 |
| **基础件库** | 元器件、标准件（螺钉螺母等）、原材料（铝合金、介质基板等）的分类管理 | P1 |
| **自动上架触发** | 项目开发流程完成后自动触发产品上架流程 | P0 |

### 4.6 技术货架模块

**原始需求**：
- 展示部门技术树，分类分领域展示
- 技术详情页（可能无实物，方法/电路均可）
- 查看技术全部文件，支持相似创建/修改/迭代/补充
- 技术分类：设计技术、试验技术、仿真技术

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **技术树可视化** | 树形/脑图展示技术体系：设计技术(集成/天线/射频/数字/电源/嵌入式)、试验、仿真 | P0 |
| **技术卡片** | 每项技术的卡片：名称、TRL等级、负责人、关联项目、文件数 | P0 |
| **TRL成熟度** | 技术就绪等级（TRL 1-9）标识和管理，采用NASA标准：TRL1基本原理发现→TRL2技术方案形成→TRL3关键功能验证→TRL4实验室环境验证→TRL5相关环境验证→TRL6系统/子系统演示→TRL7系统在实际环境演示→TRL8系统完成并通过测试→TRL9系统成功运行 | P1 |
| **技术关联图谱** | 展示技术间的依赖关系、演进路线 | P2 |
| **fork创建新技术项目** | 基于现有技术fork创建新版本进行迭代开发 | P1 |

### 4.7 知识库模块

**原始需求**：
- 分类体系：理论知识(电子书/论文/专利/专业知识)、标准规范、制度文件、流程说明(L1-L4)、正反面案例、仿真模型、软件使用指南
- 全文搜索、智能推荐、引用追踪
- 与Obsidian和Zotero集成，文件路径一致

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **多级分类体系** | 支持至少三级分类目录，管理员可灵活配置分类树 | P0 |
| **全文检索引擎** | 基于Elasticsearch/MeiliSearch，支持中文分词、关键词高亮、模糊匹配 | P0 |
| **标签系统** | 知识条目支持多标签标注，用于自动关联到项目活动 | P0 |
| **Obsidian集成** | Web端知识库目录与Obsidian Vault保持同步，支持双向同步 | P0 |
| **Zotero集成** | 引用Zotero文献库的分类和条目，论文PDF在线预览 | P0 |
| **Markdown渲染** | Web端渲染Obsidian的Markdown文件，支持Wiki链接、嵌入、Callout等语法 | P0 |
| **知识审核流程** | 知识上传需审核后发布，确保内容质量 | P1 |
| **访问统计** | 知识条目浏览量、下载量、引用次数统计 | P1 |
| **知识图谱** | 知识条目间的关联关系可视化，方便知识探索 | P2 |
| **版本管理** | 知识文档更新记录、历史版本对比 | P1 |

### 4.8 技术论坛模块

**原始需求**：
- 方便团队技术交流

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **板块分类** | 按技术领域(天线/射频/数字/电源/仿真)和通用分类(求助/分享/讨论)设置版块 | P1 |
| **帖子发布** | 支持富文本/Markdown编辑，可插入图片、代码块、公式、文件附件 | P1 |
| **回复与评论** | 支持楼中楼回复、@提及、最佳答案标记 | P1 |
| **搜索与标签** | 帖子支持标签分类，全文搜索 | P1 |
| **积分/声望** | 发帖、回复、最佳答案等获取积分，激励技术分享 | P2 |
| **知识库关联** | 优质帖子可一键归档至知识库对应分类 | P2 |

### 4.9 即时通信模块

**原始需求**：
- 网页端类似Mattermost（github.com/mattermost/mattermost，35.4K Stars，Go+React）

**需求补全**：

| 功能项 | 详细描述 | 优先级 |
|--------|----------|--------|
| **频道管理** | 公开频道（按团队/项目）、私密频道、私聊 | P0 |
| **消息功能** | 文字、图片、文件发送，Markdown格式支持，消息引用 | P0 |
| **项目频道自动创建** | 新建项目时自动创建项目沟通频道，添加项目成员 | P1 |
| **机器人集成** | 支持Webhook/Bot，项目状态变更自动推送到频道 | P1 |
| **消息搜索** | 历史消息全文搜索，按时间/人员/频道过滤 | P1 |
| **文件共享** | 频道内共享文件，支持预览和下载 | P1 |

---

## 5. 非功能需求补全

> 说明：原始需求未涉及非功能需求，以下为根据业务场景和部署环境完整补全。

### 5.1 性能需求

| 指标 | 要求 |
|------|------|
| **页面加载时间** | 首屏加载 ≤ 3秒（局域网环境） |
| **API响应时间** | 常规接口 ≤ 500ms，复杂查询 ≤ 2秒 |
| **并发用户** | 支持至少50人同时在线 |
| **文件上传** | 单文件 ≤ 500MB，支持断点续传 |
| **搜索响应** | 全文搜索 ≤ 1秒（10万条文档级别） |

### 5.2 安全需求

| 需求项 | 描述 |
|--------|------|
| **身份认证** | 用户名密码登录 + 可选二次验证（OTP） |
| **会话管理** | JWT Token，支持过期自动刷新，闲置超时自动退出 |
| **数据加密** | 传输层TLS加密，敏感数据（密码）存储加密（bcrypt） |
| **操作审计** | 关键操作全量记录（登录、文件操作、权限变更、审批） |
| **IP白名单** | 仅允许局域网指定IP段访问 |
| **防暴力破解** | 连续5次登录失败锁定账户30分钟 |

### 5.3 可用性需求

| 需求项 | 描述 |
|--------|------|
| **系统可用性** | 工作时间可用性 ≥ 99%（允许计划维护窗口） |
| **数据备份** | 每日自动备份，支持手动备份，保留至少30天 |
| **故障恢复** | 数据库故障恢复时间 ≤ 1小时 |
| **浏览器支持** | Chrome 90+、Edge 90+、Firefox 90+（局域网内统一浏览器） |

### 5.4 可维护性需求

- 模块化架构，各模块可独立部署、升级
- 配置外部化，核心参数可通过管理界面调整
- 完整的错误日志和运行监控
- 数据库Migration支持，版本升级不影响现有数据

---

## 6. 集成需求补全

### 6.1 本地软件集成（优化方案）

**设计原则**：设计师在本地工作目录进行开发，保持原有工作习惯，平台负责项目初始化和版本管理。

#### 6.1.1 工作流程

```
项目创建与同步:
┌──────────────────────────────────────────────────────────────┐
│ 1. Web端创建项目                                              │
│ 2. 服务器创建Gitea仓库 + 初始化标准目录结构                     │
│ 3. 服务器根据流程模板复制模板文件到对应目录                      │
│    （如：空白原理图.schdoc、设计方案模板.md等）                 │
│ 4. 桌面辅助程序自动clone到本地工作目录                          │
└──────────────────────────┬───────────────────────────────────┘
                           │
日常开发流程:               ▼
┌──────────────────────────────────────────────────────────────┐
│ Web端显示项目文件列表                                         │
│    ↓ 点击文件（如：原理图/main.schdoc）                        │
│ 调用 rdp://open?project=RDP-001&path=原理图/main.schdoc       │
│    ↓                                                        │
│ 桌面辅助程序定位本地工作目录对应文件                           │
│    ↓                                                        │
│ 调用本地软件打开（Altium Designer / Office / Obsidian等）      │
│    ↓ 用户在本地编辑保存                                       │
│ 文件变更保存在本地（暂不提交Git）                              │
│    ↓ 用户在Web端点击"活动完成"                                │
│ 桌面辅助程序自动执行Git commit + push                         │
│    Commit message: "完成活动'{活动名称}'：{项目编号}-{活动编号}"│
│    ↓                                                        │
│ 服务器Gitea仓库更新，Web端显示最新提交                         │
└──────────────────────────────────────────────────────────────┘
```

#### 6.1.2 桌面辅助程序功能

**核心功能**：
1. **协议注册**：注册 `rdp://` 协议处理程序
2. **项目同步**：自动clone/pull项目到本地工作目录
3. **文件打开**：解析协议，调用对应本地软件打开文件
4. **Git自动提交**：活动完成时自动commit该活动相关文件变更
5. **状态提示**：显示同步状态（已同步/有未提交变更）

**Git提交策略**：
- **日常编辑**：仅本地保存，不自动提交（避免无意义提交）
- **活动完成**：自动提交该活动所有输出文件变更
- **Commit message格式**：`完成活动"{活动名称}"：{项目编号}-{活动编号}`

#### 6.1.3 支持软件清单

| 软件 | 集成方式 | 功能描述 |
|------|----------|----------|
| **Altium Designer** | 自定义协议(rdp://) + 文件关联 | 点击.schdoc/.pcbdoc文件调用本地AD打开，自动创建项目文件 |
| **Obsidian** | Vault目录同步 + obsidian://协议 | 知识库与Obsidian Vault双向同步，点击打开Obsidian编辑 |
| **Zotero** | Zotero WebDAV/API + 文件路径映射 | 引用Zotero文献分类和条目，PDF在线预览 |
| **Microsoft Office** | 文件下载+本地打开 / OnlyOffice内嵌 | Word/Excel/PPT在线预览或编辑 |
| **Microsoft Project** | .mpp文件导入导出 | 甘特图与MS Project互操作 |
| **ANSYS/CST** | 仿真文件管理 + 参数记录 | 仿真模型文件在知识库中管理，参数可在线查看 |
| **Git** | 内置Gitea或直接调用git CLI | 项目文件版本管理，自动commit/push |

### 6.2 模块间集成

**模块间数据流关系图**：

```
用户管理 → 人员/权限 → 所有模块
项目管理 → 创建/状态同步 → 项目开发
         → 上架触发 → 产品货架
         → 知识沉淀 → 知识库
项目开发 → 技术引用 → 技术货架
产品货架 → 技术关联 → 技术货架
即时通信 → 项目频道 → 项目管理
```

---

## 7. 数据需求补全

### 7.1 核心数据实体

| 数据实体 | 说明 | 预估数据量 |
|----------|------|------------|
| **用户(User)** | 部门全员信息、角色、技能、履历 | 50-200条 |
| **项目(Project)** | 项目基本信息、状态、团队、计划 | 100-1000条/年 |
| **活动(Activity)** | 流程中的具体活动/任务 | 1000-10000条/年 |
| **文件(File)** | 项目文件、知识文档、交付物 | 10000-100000个/年 |
| **产品(Product)** | 货架产品/模块信息 | 500-5000条 |
| **技术(Technology)** | 技术条目及关联信息 | 200-2000条 |
| **知识(Knowledge)** | 知识库条目（书、论文、标准等） | 5000-50000条 |
| **流程模板(ProcessTemplate)** | 各类别流程定义 | 20-100条 |
| **消息(Message)** | 即时通信消息 | 高增长 |
| **论坛帖子(Post)** | 论坛内容 | 1000-10000条/年 |

### 7.2 数据存储策略

- **结构化数据**：PostgreSQL（用户、项目、流程等业务数据）
- **文件存储**：服务器本地文件系统（Git仓库 + MinIO对象存储）
- **全文索引**：MeiliSearch / Elasticsearch（知识库、论坛搜索）
- **缓存**：Redis（会话、热点数据缓存）

---

## 8. 需求优先级与分期规划

### 8.1 分期建设规划（AI Agent开发模式）

> **开发模式说明**：本项目采用**AI Agent自主开发模式**，各功能模块由专门的AI Agent负责开发。分期仅表示开发先后顺序，不设定具体时间限制，各Agent可并行或串行执行，由项目经理Agent统一协调。

| 阶段 | 执行顺序 | 核心内容 | 交付物 | 引入组件 | 负责AI Agent |
|------|----------|----------|--------|----------|-------------|
| **一期：基础骨架** | 第1批 | 单体前端应用、用户管理(Casdoor)、项目管理基础(CRUD+文件管理)、内置通知系统、systemd部署 | 可登录使用的基础平台，支持项目创建和文件上传下载 | PostgreSQL、Casdoor | **PortalAgent**：负责门户前端<br>**UserAgent**：负责用户管理模块<br>**ProjectAgent**：负责项目管理模块<br>**InfraAgent**：负责基础设施和部署 |
| **二期：核心业务** | 第2批 | 流程引擎(简化版状态机)、项目开发模块、甘特图、产品/技术货架、Gitea集成、本地软件联动 | 完整研发管理流程上线，支持流程执行和Git版本管理 | Gitea、Redis(可选) | **WorkflowAgent**：负责流程引擎<br>**DevAgent**：负责项目开发模块<br>**ShelfAgent**：负责产品/技术货架<br>**DesktopAgent**：负责桌面辅助程序 |
| **三期：知识智能** | 第3批 | 知识库模块、Obsidian/Zotero集成、全文搜索(MeiliSearch)、技术论坛、Mattermost集成(可选) | 知识管理体系上线，支持知识沉淀和全文搜索 | MeiliSearch、Mattermost(可选) | **KnowledgeAgent**：负责知识库模块<br>**SearchAgent**：负责全文搜索<br>**ForumAgent**：负责技术论坛 |
| **四期：优化完善** | 第4批 | 数据分析仪表盘、流程优化、性能调优、用户体验提升 | 全功能稳定版本 | - | **AnalyticsAgent**：负责数据分析<br>**各模块Agent**：负责各自模块优化 |

**开发模式特点**：
- **无固定时间限制**：各Agent按能力自主推进，项目经理Agent根据质量把关结果决定进入下一阶段
- **可并行开发**：无依赖关系的模块可由不同Agent并行开发
- **迭代式交付**：每个阶段完成后需通过项目经理Agent的质量评审

### 8.2 架构设计原则与优化说明

#### 8.2.1 技术栈选型原则

| 设计决策 | 选型 | 原因说明 |
|----------|------|----------|
| **前端架构** | 单体应用（非微前端） | 用户规模30-100人，单体架构完全满足需求；降低30-50%开发和调试复杂度；Monorepo+代码分割可满足多团队协作 |
| **后端技术栈** | 纯 Go（Gin） | 统一技术栈，团队只需掌握一种后端语言；单二进制部署简单；与Casdoor/Gitea同技术栈，便于集成 |
| **数据库** | PostgreSQL（含全文搜索） | Phase 1-2使用PostgreSQL tsvector满足搜索需求，Phase 3再引入MeiliSearch；减少初期组件数量 |
| **缓存** | 可选Redis | Phase 1使用内存缓存，Phase 2根据实际需要引入Redis；避免过早优化 |
| **文件存储** | 本地文件系统 | 部门级应用文件量预计<100GB，无需对象存储；简化部署架构 |
| **部署方式** | systemd裸机部署 | 符合涉密/军工环境要求；无Docker运行时开销；安全审查更简便 |

#### 8.2.2 组件分阶段引入策略

| 组件 | 引入阶段 | 延后原因 |
|------|----------|----------|
| Casdoor | Phase 1 | 认证是必需功能，优先实现 |
| Gitea | Phase 2 | Git版本管理是Phase 2核心功能，与本地软件联动配合使用 |
| Redis | Phase 2 | Phase 1数据量小，内存缓存足够；Phase 2根据性能需求引入 |
| MeiliSearch | Phase 3 | Phase 1-2使用PostgreSQL全文搜索；知识库上线后再引入专业搜索引擎 |
| Mattermost | Phase 3(可选) | Phase 1内置通知系统满足基本需求；IM是锦上添花功能，可延后 |

#### 8.2.3 流程引擎简化设计

| 原设计 | 优化设计 | 优化原因 |
|--------|----------|----------|
| 自研轻量BPMN引擎 | 项目模板+状态机 | 30-100人部门的项目流程相对标准，无需复杂BPMN编排；状态机简单可靠，开发周期从6周缩短至2周 |
| 支持并行活动 | 顺序执行+人工协调 | 并行活动使用频率低，实现复杂度高；初期可通过人工协调，后续根据需求迭代 |
| 自动排程引擎 | 人工设置起止时间 | 自动排程算法复杂度高，准确性难以保证；人工设置+甘特图展示更实用 |

#### 8.2.4 AI Agent开发团队配置

本项目采用**AI Agent集群开发模式**，每个功能模块、项目架构、门户网站各由专门的AI Agent负责，同时设置项目经理Agent进行全局质量把控。

**AI Agent角色定义**：

| Agent角色 | 职责范围 | 核心任务 | 交付标准 |
|-----------|----------|----------|----------|
| **PortalAgent** | 门户界面模块 | 部门首页、个人工作台、全局搜索、消息通知中心 | 前端代码、组件文档、接口对接 |
| **UserAgent** | 用户管理模块 | 用户CRUD、RBAC权限、组织架构、个人Profile页面 | 后端API、权限模型、用户服务 |
| **ProjectAgent** | 项目管理模块 | 项目创建向导、甘特图、项目文件夹、Git集成 | 项目服务、文件管理、Gitea对接 |
| **WorkflowAgent** | 流程引擎模块 | 流程模板管理、状态机引擎、活动流转 | 流程服务、状态管理、DCP评审逻辑 |
| **DevAgent** | 项目开发模块 | 流程全景视图、活动执行、本地软件联动 | 开发模块API、桌面端协议、Git提交集成 |
| **ShelfAgent** | 产品/技术货架模块 | 产品浏览筛选、技术树、选用购物车 | 货架服务、分类管理、版本控制 |
| **KnowledgeAgent** | 知识库模块 | 知识分类、文档管理、Obsidian/Zotero集成 | 知识服务、文件同步、Markdown渲染 |
| **SearchAgent** | 搜索服务模块 | 全文搜索、中文分词、搜索结果高亮 | 搜索索引、查询API、性能优化 |
| **ForumAgent** | 技术论坛模块 | 帖子发布、回复、板块管理 | 论坛服务、富文本编辑、通知集成 |
| **InfraAgent** | 基础设施模块 | 数据库设计、部署脚本、systemd配置、Nginx配置 | 基础设施即代码、部署自动化、监控配置 |
| **DesktopAgent** | 桌面辅助程序 | rdp协议实现、本地软件调用、Git自动提交 | 桌面应用程序、协议注册、文件同步 |
| **AnalyticsAgent** | 数据分析模块 | 仪表盘、统计报表、数据可视化 | 分析服务、报表生成、数据导出 |
| **PM-Agent** | **项目经理Agent** | **全局质量把控、进度协调、代码审查、标准制定** | **质量标准文档、审查报告、协调决策** |

**AI Agent协作模式**：

```
                    ┌─────────────────┐
                    │   PM-Agent      │
                    │  (项目经理)      │
                    │  - 质量把控      │
                    │  - 进度协调      │
                    │  - 标准制定      │
                    └────────┬────────┘
                             │
        ┌────────────────────┼────────────────────┐
        │                    │                    │
   ┌────▼────┐          ┌────▼────┐          ┌────▼────┐
   │Portal   │          │User     │          │Project  │
   │Agent    │          │Agent    │          │Agent    │
   └────┬────┘          └────┬────┘          └────┬────┘
        │                    │                    │
   ┌────▼────┐          ┌────▼────┐          ┌────▼────┐
   │Workflow │          │Dev      │          │Shelf    │
   │Agent    │          │Agent    │          │Agent    │
   └────┬────┘          └────┬────┘          └────┬────┘
        │                    │                    │
   ┌────▼────┐          ┌────▼────┐          ┌────▼────┐
   │Knowledge│          │Search   │          │Forum    │
   │Agent    │          │Agent    │          │Agent    │
   └────┬────┘          └────┬────┘          └────┬────┘
        │                    │                    │
        └────────────────────┼────────────────────┘
                             │
                    ┌────────▼────────┐
                    │   InfraAgent    │
                    │   DesktopAgent  │
                    │ AnalyticsAgent  │
                    └─────────────────┘
```

**PM-Agent（项目经理Agent）核心职责**：

| 职责类别 | 具体内容 | 执行方式 |
|----------|----------|----------|
| **代码质量审查** | 审查各Agent提交的代码是否符合编码规范、是否存在安全漏洞、是否满足需求规格 | 自动化代码审查工具 + 静态分析 |
| **架构一致性检查** | 确保各模块接口设计一致、数据模型统一、错误处理规范 | 架构合规性检查脚本 |
| **进度协调** | 根据各Agent完成情况和依赖关系，决定开发顺序和并行策略 | 依赖图分析 + 自动调度 |
| **标准制定** | 制定项目统一的编码规范、API规范、文档规范、测试标准 | 标准文档生成 + 规范检查 |
| **冲突解决** | 当多个Agent对同一模块有不同实现方案时，决策采用何种方案 | 方案对比评估 + 最优选择 |
| **集成测试** | 在各阶段结束时，组织集成测试，确保模块间协作正常 | 自动化集成测试 + 报告生成 |

**Agent开发交付流程**：

```
1. PM-Agent发布开发任务和需求规格
           ↓
2. 功能Agent进行模块开发
           ↓
3. 功能Agent提交代码和文档
           ↓
4. PM-Agent进行代码审查和质量检查
           ↓
   ├─ 通过 → 进入下一阶段/模块集成
   └─ 不通过 → 返回修改意见，Agent重新开发
           ↓
5. 阶段完成，PM-Agent组织集成测试
           ↓
6. 通过测试，进入下一阶段
```

### 8.3 优先级矩阵

| 优先级 | 标准 | 对应功能 |
|--------|------|----------|
| **P0 必须实现** | 业务不可或缺 | 登录认证、项目创建/管理、流程执行、文件管理、基础货架、即时通信 |
| **P1 应该实现** | 显著提升效率 | 甘特图、全文搜索、仪表盘、Obsidian/Zotero集成、DCP评审、论坛 |
| **P2 可以延后** | 锦上添花 | 技术图谱、积分系统、智能推荐、主题定制、工时统计 |

---

## 9. 需求追踪矩阵

| 需求ID | 需求名称 | 来源 | 模块 | 优先级 | 状态 |
|--------|----------|------|------|--------|------|
| REQ-001 | 部门门户首页 | 原始 | 门户 | P0 | 已确认 |
| REQ-002 | 个人工作台 | 原始 | 门户 | P0 | 已确认 |
| REQ-003 | 全局搜索 | 补全 | 门户 | P1 | 待确认 |
| REQ-004 | RBAC权限管理 | 补全 | 用户 | P0 | 待确认 |
| REQ-005 | 用户Profile（类GitHub） | 原始 | 用户 | P1 | 已确认 |
| REQ-006 | 项目创建向导 | 原始 | 项目管理 | P0 | 已确认 |
| REQ-007 | 甘特图排程 | 原始 | 项目管理 | P0 | 已确认 |
| REQ-008 | 项目文件夹+Git版本管理 | 原始 | 项目管理 | P0 | 已确认 |
| REQ-009 | 流程可视化执行 | 原始 | 项目开发 | P0 | 已确认 |
| REQ-010 | 本地软件联动 | 原始 | 项目开发 | P0 | 已确认 |
| REQ-011 | 产品货架浏览与选用 | 原始 | 产品货架 | P0 | 已确认 |
| REQ-012 | 技术树展示 | 原始 | 技术货架 | P0 | 已确认 |
| REQ-013 | 知识分类与全文搜索 | 原始 | 知识库 | P0 | 已确认 |
| REQ-014 | Obsidian/Zotero集成 | 原始 | 知识库 | P0 | 已确认 |
| REQ-015 | Mattermost即时通信 | 原始 | 即时通信 | P0 | 已确认 |
| REQ-016 | 技术论坛 | 原始 | 论坛 | P1 | 已确认 |
| REQ-017 | 操作审计日志 | 补全 | 安全 | P0 | 待确认 |
| REQ-018 | 数据备份与恢复 | 补全 | 运维 | P0 | 待确认 |
| REQ-019 | MS Project导入导出 | 原始 | 项目管理 | P1 | 已确认 |
| REQ-020 | 变更管理 | 补全 | 项目开发 | P1 | 待确认 |

---

---

## 10. 需求优化记录

### 10.1 优化概述

本文档基于原始需求进行了系统性优化，主要目标是**在保持核心功能完整的前提下，缩短交付周期、降低实施成本、提高系统可维护性**。

### 10.2 关键优化点

| 优化项 | 原方案 | 优化后方案 | 优化效果 |
|--------|--------|-----------|----------|
| **实施周期** | 12个月 | 5个月 | 缩短58% |
| **团队规模** | 7-9人 | 5人 | 降低40% |
| **前端架构** | 微前端(Module Federation) | 单体应用 | 复杂度降低30% |
| **后端技术栈** | Go + Node.js | 纯 Go | 技术栈统一 |
| **部署方式** | Docker Compose | systemd裸机部署 | 符合涉密环境要求 |
| **流程引擎** | 自研BPMN引擎 | 项目模板+状态机 | 开发周期缩短4周 |
| **组件引入** | 早期全部引入 | 分阶段引入 | 降低初期复杂度 |

### 10.3 优化原因详细说明

#### 10.3.1 为什么采用单体前端而非微前端？

**原始需求**：多团队独立开发模块

**优化决策**：采用单体应用 + Monorepo 架构

**原因分析**：
1. **用户规模适配**：30-100人的部门级应用，单体应用完全满足性能和可维护性需求
2. **复杂度控制**：微前端增加30-50%的开发和调试复杂度，包括：
   - 构建配置复杂（Module Federation配置繁琐）
   - 运行时兼容性问题（样式隔离、全局状态共享）
   - 调试困难（跨应用问题定位）
3. **团队协作**：Monorepo + 代码分割可实现代码共享，路由懒加载实现按需加载
4. **长期维护**：单体应用代码集中，重构和升级更简单

#### 10.3.2 为什么采用纯Go技术栈？

**原始方案**：Go（核心业务）+ Node.js（流程引擎、文件处理）

**优化决策**：纯 Go 技术栈

**原因分析**：
1. **团队效率**：团队只需掌握一种后端语言，降低学习成本和上下文切换成本
2. **部署简化**：单二进制文件部署，无需管理多个运行时环境
3. **生态统一**：Casdoor、Gitea均为Go项目，便于深度集成和问题排查
4. **性能一致**：避免Node.js事件循环与Go Goroutine的混用带来的性能不确定

#### 10.3.3 为什么活动完成时才自动Git提交？

**原始方案**：文件监听自动commit（每次保存都提交）

**优化决策**：日常编辑仅本地保存，活动完成时统一commit

**原因分析**：
1. **Git历史清晰**：避免频繁保存产生大量无意义提交（如"修改了第3行"、"修改了错别字"）
2. **语义化提交**：活动完成时提交，commit message为"完成活动'原理图设计'：RDP-001-ACT003"，清晰表达变更目的
3. **符合工作习惯**：设计师在本地工作目录开发，与原有工作方式一致，仅在阶段性工作完成后提交
4. **可回溯性**：每个Git提交对应一个活动的完成，便于追溯和回滚

#### 10.3.4 为什么分阶段引入组件？

**原始方案**：Phase 1引入Mattermost、Redis、MeiliSearch等全部组件

**优化决策**：核心组件Phase 1引入，其他组件延后

**原因分析**：
1. **MVP原则**：Phase 1只需"能用"，Phase 2"好用"，Phase 3"完善"
2. **避免过早优化**：Phase 1数据量小（<100用户），PostgreSQL内置全文搜索足够
3. **降低风险**：组件越多，集成风险越大，分阶段引入便于问题定位
4. **资源优化**：初期服务器资源需求降低50%（8核/32GB vs 16核/64GB）

#### 10.3.5 为什么简化流程引擎？

**原始方案**：自研轻量BPMN引擎，支持并行活动、网关、事件

**优化决策**：项目模板 + 状态机，顺序执行

**原因分析**：
1. **场景适配**：30-100人部门的项目流程相对标准，复杂BPMN功能使用频率低
2. **开发成本**：BPMN引擎开发周期6-8周，状态机2周即可实现
3. **可靠性**：状态机逻辑简单清晰，易于测试和维护
4. **可演进**：后续如需要并行活动，可在状态机基础上扩展，无需推翻重做

#### 10.3.6 为什么采用systemd裸机部署？

**原始约束**：不使用Docker和Kubernetes

**优化决策**：systemd + 二进制文件部署

**原因分析**：
1. **符合约束**：满足涉密/军工环境对容器技术的限制
2. **资源效率**：无容器运行时开销，同等硬件可支持更多业务负载
3. **安全审查**：二进制文件比容器镜像更易审计，无层叠依赖
4. **故障排查**：systemd日志统一管理，问题定位更直观

### 10.4 AI Agent开发模式（V1.2新增）

#### 10.4.1 为什么采用AI Agent开发模式？

**背景**：传统软件开发依赖人工团队，存在沟通成本高、进度难以预测、质量难以统一等问题。

**决策**：采用AI Agent集群自主开发模式，每个功能模块由专门的AI Agent负责。

**原因分析**：
1. **专业化分工**：每个Agent专注于特定模块，知识深度超过全栈开发人员
2. **并行开发能力**：无依赖的模块可并行开发，不受人力资源限制
3. **代码质量统一**：PM-Agent制定统一标准，避免不同开发人员风格差异
4. **24/7持续开发**：Agent可持续工作，无需考虑工作时间和疲劳问题
5. **快速迭代**：发现问题可立即修改，无需等待排期和人力协调

#### 10.4.2 为什么去掉具体时间限制？

**传统方案**：设定固定时间（如6周、4周）

**优化决策**：仅保留先后顺序，不设定具体时间

**原因分析**：
1. **AI Agent能力差异**：不同Agent处理不同复杂度任务的速度差异较大
2. **质量优先原则**：由PM-Agent根据代码质量决定何时进入下一阶段，而非时间
3. **灵活调整**：可根据实际情况调整开发顺序，不受时间约束
4. **避免赶工**：去除时间压力，确保每个模块达到质量标准

#### 10.4.3 为什么设置PM-Agent（项目经理Agent）？

**背景**：多个AI Agent独立开发，需要统一协调和质量把控。

**决策**：设置专门的PM-Agent负责全局质量把控和进度协调。

**PM-Agent核心职责**：

| 职责 | 说明 | 必要性 |
|------|------|--------|
| **代码审查** | 审查各Agent提交的代码是否符合规范 | 确保代码质量，避免Agent产生低质量代码 |
| **架构一致性** | 确保接口设计、数据模型统一 | 避免各Agent各自为政，确保系统整体性 |
| **进度协调** | 根据依赖关系决定开发顺序 | 优化开发流程，减少等待时间 |
| **冲突解决** | 决策多个Agent的不同方案 | 避免僵局，确保项目推进 |
| **集成测试** | 组织阶段集成测试 | 确保模块间协作正常 |

**PM-Agent与功能Agent的关系**：
- **不是上下级关系**：PM-Agent不直接指挥功能Agent，而是制定标准和审查结果
- **反馈循环**：功能Agent提交 → PM-Agent审查 → 反馈修改意见 → 功能Agent改进
- **质量门禁**：只有通过PM-Agent审查的代码才能进入下一阶段

### 10.5 保持不变的决策

以下需求保持原始方案，未做优化：

| 需求 | 保持原因 |
|------|----------|
| **本地软件集成** | 核心需求，必须支持与Altium Designer等本地软件联动 |
| **DCP评审** | 符合IPD流程规范，是研发管理的关键控制点 |
| **产品/技术货架** | 部门"平台化+模块化"战略的核心支撑 |
| **Git版本管理** | 设计文档版本控制是刚需，Gitea满足需求 |
| **知识库Obsidian集成** | 设计师知识沉淀的重要工具，保持集成方案 |

### 10.6 文档修订记录

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|----------|
| V1.0 | 2026-02-20 | 需求分析团队 | 初稿编制 |
| V1.1 | 2026-02-21 | 架构优化团队 | 1. 优化本地软件集成方案（活动完成自动Git提交）<br>2. 调整技术栈（单体前端、纯Go后端）<br>3. 优化分期规划（12个月→5个月）<br>4. 增加架构设计原则说明 |
| V1.2 | 2026-02-21 | AI工程团队 | 1. 变更开发模式为AI Agent集群开发<br>2. 重新定义AI Agent角色和职责<br>3. 增加PM-Agent（项目经理Agent）职责说明<br>4. 去掉具体时间限制，仅保留先后顺序 |

---

**文档结束**

---

**编制：** 需求分析团队  
**审核：** _______________  
**批准：** _______________  
**日期：** 2026-02-20  
**版本：** V1.2（AI Agent开发版）
